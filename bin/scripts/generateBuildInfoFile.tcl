proc genCore {scriptEnvironment fpgaSize} {
   
   
   #set global var here 
    set srcDir ""
    set svn_subwcrev ""
    set hwFile ""
    set elfFile ""
    set bootFile ""
    set commonDir ""
    source $scriptEnvironment
    setEnvironmentVariable $fpgaSize
    puts "$srcDir"
    set parentDirectory_path "${srcDir}/BuildInfo"
    set buildInfoFile  "${parentDirectory_path}/BuildInfo.h"
    puts $buildInfoFile
    set Vfo [open $buildInfoFile a]
    if {$fpgaSize == "16"} {
        #clear file
        chan truncate $Vfo 0
        puts $Vfo  "/**"
        puts $Vfo  " * This file declares the BuildInfo"
        puts $Vfo  " *"
        puts $Vfo  " * *************************"
        puts $Vfo  " * DO NOT EDIT THIS FILE !!!"
        puts $Vfo  " * *************************"
        puts $Vfo  " *"
        puts $Vfo  " * This file is automatically generated by the script generateBuildInfoFile.tcl"
        puts $Vfo  " * (c) Copyright 2018 Telops Inc."
        puts $Vfo  " *"
        puts $Vfo  "*/"
        puts $Vfo  "#ifndef BUILDINFO_H"
        puts $Vfo  "#define BUILDINFO_H" 
        puts $Vfo   " "
        puts $Vfo  "#if MEMCONF == 16"
        puts $Vfo   " "

    } 
    if {$fpgaSize == "32"} {
        puts $Vfo   " "
        puts $Vfo   "#elif MEMCONF == 32"
        puts $Vfo   " "

    } 

    # Get hardware revision
    #%svn_subwcrev% %hwFile% %buildInfoFile% %buildInfoFile%
    set localModif "\$WCMODS?-:\$\$WCREV\$"
    puts $Vfo "#define SVN_HARDWARE_REV ${localModif}"
    close $Vfo
    if {[ catch {[exec "C:/Program Files/TortoiseSVN/bin/SubWCRev.exe" ${hwFile}  ${buildInfoFile}  ${buildInfoFile}]} ]} {
        set errorsvn 0
        puts "SubWCRev.exe Hw done"
    }
    set Vfo [open $buildInfoFile a]
    # Get software revision
    #%svn_subwcrev% %elfFile% %buildInfoFile% %buildInfoFile%
    puts $Vfo  "#define SVN_SOFTWARE_REV      ${localModif}"
    close $Vfo
    if {[ catch {[exec "C:/Program Files/TortoiseSVN/bin/SubWCRev.exe" ${elfFile}  ${buildInfoFile}  ${buildInfoFile}]} ]} {
        set errorsvn 0
        puts "SubWCRev.exe Sw done"
    }
    set Vfo [open $buildInfoFile a]
    # Get boot loader revision
    puts $Vfo  " #define SVN_BOOTLOADER_REV    0 "

    # Get common directory revision
    #%svn_subwcrev% %commonDir% %buildInfoFile% %buildInfoFile%
    puts $Vfo  " #define SVN_COMMON_REV      ${localModif}"
    close $Vfo
    if {[ catch {[exec "C:/Program Files/TortoiseSVN/bin/SubWCRev.exe" ${commonDir} ${buildInfoFile}  ${buildInfoFile}]} ]} {
       set errorsvn 
       puts "SubWCRev.exe Common done"
    }
    set Vfo [open $buildInfoFile a]
    # Check for uncommitted changes
    puts $Vfo   " "
    puts $Vfo "#define SVN_UNCOMMITTED_CHANGES  ((SVN_HARDWARE_REV < 0) || (SVN_SOFTWARE_REV < 0) || (SVN_BOOTLOADER_REV < 0) || (SVN_COMMON_REV < 0))"
    puts $Vfo   " "
    puts $Vfo  "#if SVN_UNCOMMITTED_CHANGES"
    puts $Vfo  "#warning Uncommitted changes detected"
    puts $Vfo  "#endif"

    if {$fpgaSize == "32"} {
        puts $Vfo   " "
        puts $Vfo   "#endif  // FPGA_ARCH Check"
        puts $Vfo   " "
        puts $Vfo   "#endif // BUILDINFO_H"
    }

    close $Vfo
}



# WCREV : Replaced with the highest commit revision in the working copy.
#$WCMODS?TText:FText$ is replaced with TText if there are local modifications, or FText if not.


set scriptEnvironment "D:/Telops/FIR-00257-Storage/bin/scripts/setEnvironment.tcl"
source $scriptEnvironment

genCore  $scriptEnvironment "16"

genCore  $scriptEnvironment "32"
